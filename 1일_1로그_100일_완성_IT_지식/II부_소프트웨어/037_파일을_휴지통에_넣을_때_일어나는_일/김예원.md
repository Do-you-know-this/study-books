# 2부. 소프트웨어

## 037. 파일을 휴지통에 넣을 때 일어나는 일

- 파일 제거하기
  - 파일의 블록이 미사용 목록으로 돌아가고 파일의 폴더 엔트리는 삭제돼서 파일이 사라진 것처럼 보임
  - 휴지통: 일부 속성이 조금 다르다는 점을 제외하면 그저 또 다른 폴더처럼 보임
    - 파일이 제거되기로 하면 그 파일의 폴더 엔트리와 전체 이름이 현재 폴더에서 휴지통이라는 폴더로 복사되고 원래 폴더 엔트리는 지워짐
    - 파일의 블록과 그 내용은 전혀 바뀌지 않음
  - 휴지통에서 파일을 복원할 때는 이 과정을 정반대로 수행해서, 엔트리를 원래 폴더로 복구함
  - 휴지통 비우기가 원래 의도했던 제거 작업에 더 가까움
    - 휴지통에 있는 폴더 엔트리가 지워지고 블록은 미사용 목록에 추가됨
    - 하지만 블록 내용은 아직 삭제되지 않은 상태로, 원래 파일에 할당된 각 블록의 모든 바이트는 아직 그대로 있음
    - 해당 블록이 미사용 목록에서 꺼내져서 새로운 파일에 할당되기 전까지는 새로운 내용으로 덮어 쓰이지 않음
  - 파일 복구 툴의 작동 원리 ex) 2020년 중반에 마이크로소프트가 발표한 윈도우 파일 복구 (Windows File Recovery)
    - 삭제가 바로 일어나지 않는다는 것은 내가 제거했다고 생각한 정보가 아직 존재하고, 누군가 그 정보를 찾을 방법을 안다면 손쉽게 접근할 수 있음을 뜻함
    - 물리적 블록 단위로 드라이브를 읽는 프로그램, 즉 파일 시스템 계층 구조를 통하지 않고 디스크를 읽는 프로그램이라면 예전 내용을 확인할 수 있음
- 이러한 과정에는 잠재적인 이점이 있음. 디스크에 뭔가 이상이 생겨 파일 시스템이 엉망이 되었을 때도 아직 정보를 복원할 수 있을 가능성이 있음
  - 하지만 파일을 제거해도 데이터가 완전히 사라졌다는 보장이 없는 게 싫다면 블록이 미사용 상태가 된 후에도 정보를 지우는 프로그램을 사용해야 함
  - 실제로는 기존 정보가 새로운 정보로 덮어 쓰였대도 약간이라도 남아 있는 정보를 추출할지도 모름
  - 군에서는 블록을 무작위 패턴으로 된 0, 1 값을 여러 번 덮어 씌움으로써 파일을 제거함
  - 하드 디스크를 강한 자석 근처에 놓아 자성을 없애 버리는 게 더 좋은 방법임
  - 물리적으로 파괴하는 게 최선의 방법임
  - 하지만 만약 데이터가 항상 자동으로 백업되고 있거나 자신의 드라이브 대신 네트워크 파일 시스템이나 '클라우드' 어디엔가에 파일이 보관되고 있다면 이마저도 부족함
- 이와 같은 파일 제거 프로세스는 폴더 엔트리 자체에도 어느 정도 비슷하게 적용됨
  - 디스커버리 제도, 문서 보존 같은 법적 절차에 대한 시사점을 제공함
  - 디지털 기록은 빠르게 확산되고 이동식 장치로도 손쉽게 복사되고 많은 곳에 숨겨지기 때문

- 보조 기억 장치 드라이브에 사용되는 종래의 파일 시스템 이외의 다른 저장 매체에 대한 파일 시스템 추상화
  - CD-ROM, DVD
    - 보조 기억 장치 드라이브와 마찬가지로 폴더와 파일 계층 구조로 되어 있는 파일 시스템처럼 정보에 접근하게 함
  - USD 드라이브, SD카드의 플래시 메모리 파일 시스템
    - 이 저장 매체를 윈도우 컴퓨터에 연결하면 또 다른 디스크 드라이브로 나타남
    - 저장된 내용을 파일 탐색기로 탐색할 수 있고 내장 드라이브와 똑같이 파일을 읽고 쓸 수 있음
    - 유일한 차이는 용량이 더 작고 접근 속도가 다소 느릴 수 있다는 점
- 소프트웨어는 물리적인 장치가 파일 시스템처럼 보이게 하며, 다양한 운영체제에서도 동일하게 추상화된 폴더와 파일 구조로 나타나게 함
  - 하드웨어 인터페이스와 소프트웨어 구조의 표준화 덕분에 이러한 추상화가 가능함
  - 표준화된 매체를 이용해 친숙하고 균일한 인터페이스를 사용할 수 있게 됐다. 제조사도 더 이상 전용 파일 소프트웨어를 제공하지 않아도 돼서 편할 것
- 다른 표준화의 예: 네트워크 파일 시스템
  - 네트워크 파일 시스템
    - 소프트웨어를 활용해서 다른 컴퓨터의 파일 시스템이 마치 자신의 컴퓨터에 있는 것처럼 파일 탐색기, 파일더, 또는 다른 프로그램을 사용하여 접근하게 해줌
    - 플래시 메모리 기반 장치와 마찬가지로, 소프트웨어가 차이점은 숨기고 균일한 인터페이스를 제공함으로써 파일 구조가 로컬 컴퓨터에 있는 일반 파일 시스템처럼 보이게 함
    - 네트워크 파일 시스템은 주된 파일 저장소로도 사용되지만 백업 용도로도 자주 쓰임
      - 파일의 이전 버전 여러 개를 서로 다른 위치에 있는 보관용 저장 매체로 복사해둠
        - 랜섬웨어 공격이나 중대한 기록의 원본은 훼손할 우려가 있는 화재 같은 재난에서 데이터를 지킬 수 있음
      - 어떤 디스크 시스템은 RAID(Redundant Array of Independent Disks, 복수 배열 독립 디스크) 기법을 활용함
        - 디스크 중 하나가 고장 나더라도 정보를 복원할 수 있게 하는 오류 수정 알고리즘을 이용하여 여러 개의 디스크에 데이터를 기록함
        - 물론 이러한 시스템은 정보의 모든 흔적을 확실히 지우기 어렵게 만드는 요인이 되기도 함
